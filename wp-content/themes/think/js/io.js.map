{"version":3,"sources":["webpack:///./wp-content/themes/think/src/js/components/io.js"],"names":["Io","resized","minThreshold","superWindow","h","breakpoints","vertical","xs","indexThreshold","thresholdsNumber","thresholdSamples","offersMenu","document","getElementById","offersAnchors","getElementsByTagName","menuOffersEntries","activeId","init","objectsToIO","slice","call","querySelectorAll","observer","IntersectionObserver","entries","forEach","entry","intersectionRatio","target","dataset","io","hasAttribute","unobserve","threshold","rootMargin","obj","observe","setAttribute","updateBorderIn","borders","event","createNewEvent","getAttribute","dispatchEvent","updateOffersMenuIn","length","id","ratio","setRatio","value","classList","add","anchor","remove","revealNewsletterIn"],"mappings":"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","file":"io.js","sourcesContent":["import 'intersection-observer';\nimport { superWindow } from '@stereorepo/sac';\nimport { forEach, createNewEvent } from '../utils';\n\nfunction Io() {\n    this.resized = true;\n    const minThreshold =\n        superWindow.h > superWindow.breakpoints.vertical.xs ? 0.15 : 0.1;\n    let indexThreshold = 0;\n    const thresholdsNumber = 10;\n    const thresholdSamples = [];\n\n    // NOTE: offers menu part\n    let offersMenu = document.getElementById('offers-menu');\n    let offersAnchors = offersMenu\n        ? [...offersMenu.getElementsByTagName('a')]\n        : null;\n    const menuOffersEntries = {\n        activeId: null,\n    };\n\n    for (\n        indexThreshold;\n        indexThreshold <= thresholdsNumber;\n        indexThreshold += 1\n    ) {\n        thresholdSamples[indexThreshold] = indexThreshold / thresholdsNumber;\n    }\n    this.init = () => {\n        const objectsToIO = [].slice.call(\n            document.querySelectorAll('[data-io]')\n        );\n\n        const observer = new IntersectionObserver(\n            entries => {\n                forEach(entries, entry => {\n                    if (entry.intersectionRatio > minThreshold) {\n                        this[`${entry.target.dataset.io}In`](entry);\n                        if (entry.target.hasAttribute('data-io-single'))\n                            observer.unobserve(entry.target);\n                    }\n                    // else if (entry.intersectionRatio < threshold) {\n                    //     this[`${entry.target.dataset.io}Out`](entry.target);\n                    // }\n                });\n            },\n            {\n                threshold: thresholdSamples,\n                rootMargin: '-100px 0px',\n            }\n        );\n\n        forEach(objectsToIO, obj => {\n            if (obj.hasAttribute('data-io-observed')) return;\n\n            observer.observe(obj);\n            obj.setAttribute('data-io-observed', '');\n        });\n    };\n\n    // Reveal minions\n    this.updateBorderIn = entry => {\n        const { target } = entry;\n        const borders = document.getElementById('borders');\n\n        if (!borders) return;\n\n        const event = createNewEvent('updateBorders');\n\n        borders.setAttribute(\n            'data-next-section',\n            target.getAttribute('data-section-name')\n        );\n        borders.dispatchEvent(event);\n    };\n\n    this.updateOffersMenuIn = entry => {\n        const { target } = entry;\n\n        if (!offersMenu) {\n            offersMenu = document.getElementById('offers-menu');\n        }\n        if (!offersAnchors.length) {\n            offersAnchors = [...offersMenu.getElementsByTagName('a')];\n        }\n\n        if (!offersMenu) return;\n\n        if (!menuOffersEntries[target.id]) {\n            menuOffersEntries[target.id] = {\n                ratio: 0,\n                set setRatio(value) {\n                    this.ratio = value;\n\n                    if (!menuOffersEntries.activeId) {\n                        menuOffersEntries.activeId = {\n                            id: this.target.id,\n                            ratio: this.ratio,\n                        };\n\n                        document\n                            .getElementById(`anchor-${this.target.id}`)\n                            .classList.add('active');\n                    } else {\n                        if (this.target.id === menuOffersEntries.activeId.id) {\n                            menuOffersEntries.activeId.ratio = this.ratio;\n                        }\n\n                        if (this.ratio > menuOffersEntries.activeId.ratio) {\n                            menuOffersEntries.activeId = {\n                                id: this.target.id,\n                                ratio: this.ratio,\n                            };\n                        }\n\n                        forEach(offersAnchors, anchor => {\n                            if (\n                                anchor.id ===\n                                `anchor-${menuOffersEntries.activeId.id}`\n                            ) {\n                                anchor.classList.add('active');\n                            } else {\n                                anchor.classList.remove('active');\n                            }\n                        });\n                    }\n                },\n            };\n        }\n        menuOffersEntries[target.id].target = target;\n        menuOffersEntries[target.id].setRatio = entry.intersectionRatio;\n    };\n\n    this.revealNewsletterIn = ({ target }) => {\n        target.classList.add('activated');\n    };\n}\n\nexport default new Io();\n"],"sourceRoot":""}